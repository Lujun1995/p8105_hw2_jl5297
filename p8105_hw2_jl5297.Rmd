---
title: "p8105_hw2_jl5297"
author: "Jun Lu"
date: "9/25/2018"
output: github_document
---
## Executive Summary
This my second homework for Data Science, including my solutions to Problems 1, 2 and 3. And I was praciticing data wrangling and tidy data through this homework.

## Load Packages
```{r, warning=FALSE, message=FALSE}
library(tidyverse)
library(readxl)
```

## Problem 1
This problem focuses on NYC Transit data; in particular, this CSV file contains information related to each entrance and exit for each subway station in NYC.    

### 1. Read and clean the data
Read and clean the NYC Transit data
```{r, message=FALSE, warning=FALSE}
nyc = 
    read_csv("./data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv") %>% 
    janitor::clean_names() %>% 
    select(line:entry, vending, ada) %>% 
    mutate(entry = ifelse(entry == "YES", T, F))

head(nyc)
```
The nyc_transit dataset contains variables including line, station, name, station latitude / longitude, routes served(route number and route name), entry, vending, entrance type, and ADA compliance. I load the data, clean the varibales name, select needed variables and convert the entry variable from character (YES vs NO) to a logical variable. This data set have `r nrow(nyc)` rows and `r ncol(nyc)` columns. These data is not tidy, because there are variables in columns' names. And I think it should add a column to tell which entrance it is because it is quite confusing now.

### 2. Solution to questions
**a. Count distinct stations**
```{r}
nyc_unique = unique(nyc[c("line", "station_name", "ada")])
nrow(nyc_unique)
```
There are 465 distinct stations.
       
       
**b. Count stations which are ADA compliant**
```{r}
nyc_unique %>% filter(ada == T) %>% nrow()
```
There are 84 stations which are ADA compliant.
     
          
**c. Calculate proportion of station entrances / exits without vending allow entrance**
```{r}
entran_num = nrow(nyc)
nyc %>% filter(entry == T, vending == "NO") %>% nrow() / entran_num
```
The proportion of station entrances / exits without vending allow entrance is about 0.037
     
     
### 3. Reformat data
Reformat data so that route number and route name are distinct variables. After reforming, I delete the line with NA in route name to make this dataset more tidy.
```{r}
nyc_reform = nyc %>% 
    gather(key = route_number, value = route_name, route1:route11) %>% 
    select(line, station_name, route_number, route_name, ada, everything()) %>%
    filter(!is.na(route_name)) %>%  
    arrange(line, station_name)

head(nyc_reform)
```

### 4. Solutions to questions
**a. Count distinct stations which serve the A train**
```{r}
nyc_reform_unique = unique(nyc_reform[c("line", "station_name",  "route_name", "ada")])
nyc_reform_unique %>% filter(route_name == "A") %>% nrow()
```
There 60 distinct stations which serve the A train.

**b. Count how many distinct stations which serve the A train are ADA compliant**
```{r}
nyc_reform_unique %>% filter(route_name == "A", ada == T) %>% nrow()
```
There are 17 distinct stations which serve the A train and are ADA compliant.

## Problem 2
### 1. Read and clean data
**a. Read and clean the Mr. Trash Wheel sheet.**
```{r}
trash = read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                   sheet = 1, range = "A2:N258") %>% 
    janitor::clean_names() %>% 
    rename(weight = weight_tons, volume = volume_cubic_yards) %>% 
    filter(!is.na(dumpster)) %>% 
    mutate(sports_balls = as.integer(round(sports_balls, 0)))

head(trash)
```

**b. Read and clean precipitation data for 2017.**
```{r}
precip_2017 = read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                         sheet = 3, range = "A2:B14") %>%
    janitor::clean_names() %>% 
    rename(precipitation = total) %>% 
    filter(!is.na(precipitation)) %>% 
    mutate(year = "2017")
```

**c. Read and clean precipitation data for 2016.**
```{r}
precip_2016 = read_excel("./data/HealthyHarborWaterWheelTotals2017-9-26.xlsx",
                         sheet = 4, range = "A2:B14") %>%
    janitor::clean_names() %>% 
    rename(precipitation = total) %>% 
    filter(!is.na(precipitation)) %>% 
    mutate(year = "2016")
```

**d. Combine datasets and convert month to a character variable**
```{r}
precip = bind_rows(precip_2016, precip_2017) %>% 
    select(year, everything()) %>% 
    mutate(month = month.name[month])
head(precip)
```
??? give example of key varibales

### 2. Solutions to questions
**a. Total precipitation in 2017**
```{r}
precip_sum = precip %>% group_by(year) %>% summarise(sum(precipitation))
precip_sum
```
Total precipitation in 2017 is 29.9.

**b. The median number of sports balls in a dumpster in 2016**
```{r}
trash %>% filter(year == 2016) %>% summarise(median(sports_balls))
    
```
The median number of sports balls in a dumpster in 2016 is 26.

##









